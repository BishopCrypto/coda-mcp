# coda-mcp-client

> Complete Coda API client with MCP integration for AI automation

[![npm version](https://badge.fury.io/js/coda-mcp-client.svg)](https://www.npmjs.com/package/coda-mcp-client)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

A production-ready Coda API client that solves real problems in the Coda ecosystem. Built by [Ryan Scott](https://github.com/BishopCrypto) at [The Developers](https://thedevelopers.dev) to fill gaps in existing tools and provide seamless AI automation through Model Context Protocol (MCP) integration.

## üöÄ Why This Client?

**Fixes What's Broken:**
- ‚úÖ **Page creation/updates that actually work** (existing tools have broken API calls)
- ‚úÖ **Complete table operations** with proper error handling
- ‚úÖ **Support for replace/append modes** for page content
- ‚úÖ **Markdown & HTML content support**

**Powers AI Automation:**
- ü§ñ **MCP integration** for Claude and other AI systems
- üîß **CLI + programmatic API** - works both ways  
- üéØ **Production-tested** with real workflows
- üì° **No external dependencies** - just Node.js built-ins

## üì¶ Installation

```bash
npm install coda-mcp-client

# Or use globally for CLI
npm install -g coda-mcp-client
```

## üîë Setup

Get your API key from [coda.io/account](https://coda.io/account) and set it:

```bash
export CODA_API_KEY="your-api-key-here"
```

## üèóÔ∏è Usage

### Programmatic API

```javascript
const CodaClient = require('coda-mcp-client');

const client = new CodaClient(process.env.CODA_API_KEY);

// List documents
const docs = await client.listDocs();

// Find document by name
const doc = await client.findDocByName('My Project');

// Get table data
const rows = await client.listRows(docId, tableId, { 
    limit: 50, 
    useColumnNames: true 
});

// Insert new row
await client.insertRow(docId, tableId, {
    'Name': 'John Doe',
    'Email': 'john@example.com',
    'Status': 'Active'
});

// Create page with content
const page = await client.createPage(docId, {
    name: 'New Report',
    subtitle: 'Generated by AI'
});

// Update page content (supports markdown/html)
await client.updatePageContent(docId, page.id, `
# My Report

This page was created via the API!

## Data Summary
- Total items: 42
- Status: Complete
`, 'replace', 'markdown');
```

### Command Line Interface

```bash
# List all documents
coda-mcp list-docs

# Find document by name
coda-mcp find-doc "Project Tracker"

# List tables in a document
coda-mcp list-tables doc-abc123

# Get table data (limit to 10 rows)
coda-mcp list-rows doc-abc123 grid-xyz789 10

# Insert new row
coda-mcp insert-row doc-abc123 grid-xyz789 '{"Name":"Jane","Status":"New"}'

# Create page
coda-mcp create-page doc-abc123 '{"name":"Weekly Report","subtitle":"Team Update"}'

# Update page content
coda-mcp update-page-content doc-abc123 page-def456 "# Updated content" replace markdown
```

## ü§ñ MCP Integration (Claude AI)

This client is designed for seamless integration with Claude's Model Context Protocol:

### 1. Basic MCP Server Setup

```javascript
const { CodaMCPServer } = require('coda-mcp-client/examples/mcp-integration');

const server = new CodaMCPServer(process.env.CODA_API_KEY);

// Get available tools for Claude
const tools = server.getTools();

// Execute tool calls from Claude
const result = await server.executeTool('coda_list_docs', {});
```

### 2. Claude Desktop Integration

Add to your Claude Desktop configuration:

```json
{
  "mcpServers": {
    "coda": {
      "command": "node",
      "args": ["/path/to/your/coda-mcp-server.js"],
      "env": {
        "CODA_API_KEY": "your-api-key"
      }
    }
  }
}
```

### 3. Available MCP Tools

- `coda_list_docs` - List all accessible documents
- `coda_find_doc` - Find document by name  
- `coda_list_tables` - List tables in a document
- `coda_analyze_table` - Get sample data for AI analysis
- `coda_insert_row` - Insert new rows via conversation
- `coda_create_page` - Create pages with AI-generated content
- `coda_search_data` - Search for specific information

## üìö API Reference

### Documents

- `listDocs()` - List all accessible documents
- `getDoc(docId)` - Get document details
- `findDocByName(name)` - Find document by name

### Tables  

- `listTables(docId)` - List tables in document
- `getTable(docId, tableId)` - Get table details
- `createTable(docId, tableData)` - Create new table
- `listColumns(docId, tableId)` - List table columns

### Rows

- `listRows(docId, tableId, options)` - List rows with options
- `getRow(docId, tableId, rowId)` - Get specific row
- `insertRow(docId, tableId, cells, options)` - Insert new row
- `updateRow(docId, tableId, rowId, cells)` - Update existing row
- `deleteRow(docId, tableId, rowId)` - Delete row
- `searchRows(docId, tableId, column, value)` - Search rows

### Pages

- `listPages(docId)` - List pages in document
- `getPage(docId, pageId)` - Get page details  
- `createPage(docId, pageData)` - Create new page
- `updatePageContent(docId, pageId, content, mode, format)` - Update page content
- `updatePageMetadata(docId, pageId, metadata)` - Update page metadata

## üîß Advanced Features

### Error Handling

The client provides detailed error messages and proper HTTP status code handling:

```javascript
try {
    await client.insertRow(docId, tableId, data);
} catch (error) {
    if (error.message.includes('401')) {
        console.log('Invalid API key');
    } else if (error.message.includes('404')) {
        console.log('Document or table not found');
    } else {
        console.log('Other error:', error.message);
    }
}
```

### Batch Operations

```javascript
// Insert multiple rows efficiently
const rows = [
    { 'Name': 'Alice', 'Status': 'Active' },
    { 'Name': 'Bob', 'Status': 'Pending' }
];

for (const rowData of rows) {
    await client.insertRow(docId, tableId, rowData);
}
```

### Content Modes

Page updates support different insertion modes:

```javascript
// Replace entire page content
await client.updatePageContent(docId, pageId, newContent, 'replace');

// Append to existing content  
await client.updatePageContent(docId, pageId, additionalContent, 'append');
```

## üõ†Ô∏è Development

### Running Examples

```bash
# Basic usage example
node examples/basic-usage.js

# MCP integration example  
node examples/mcp-integration.js

# CLI test
npm test
```

### Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Add tests and examples
5. Submit a pull request

## üìÑ License

MIT License - see [LICENSE](LICENSE) file for details.

## üôã Support

- **Issues**: [GitHub Issues](https://github.com/BishopCrypto/coda-mcp/issues)
- **Documentation**: [GitHub Wiki](https://github.com/BishopCrypto/coda-mcp/wiki)
- **Community**: [The Developers Discord](https://discord.gg/thedevelopers)
- **Website**: [https://thedevelopers.dev](https://thedevelopers.dev)
- **Author**: [Ryan Scott](https://github.com/BishopCrypto)

## üåü Why We Built This

At [The Developers](https://thedevelopers.dev), we build tools that developers actually want to use. Created by [Ryan Scott](https://github.com/BishopCrypto), this client was built because existing Coda clients had broken functionality and missing features. We built this one to:

1. **Actually work** with the current Coda API
2. **Support AI automation** through MCP integration  
3. **Provide complete functionality** including page management
4. **Offer great developer experience** with CLI + programmatic access

Built with ‚ù§Ô∏è by [Ryan Scott](https://github.com/BishopCrypto) at [The Developers](https://thedevelopers.dev)

---

*This package is not officially affiliated with Coda. Coda is a trademark of Coda Project, Inc.*
